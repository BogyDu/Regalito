<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Spots de Surf cerca de Valencia</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f4f9ff;
      margin: 0;
      padding: 2rem;
      color: #333;
    }

    h1 {
      text-align: center;
      color: #0077b6;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 2rem;
      background-color: white;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }

    th, td {
      border: 1px solid #ccc;
      padding: 1rem;
      text-align: left;
    }

    th {
      background-color: #0077b6;
      color: white;
    }

    #popup {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.6);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #popupContent {
      background: white;
      padding: 2rem;
      border-radius: 10px;
      width: 300px;
      text-align: center;
    }

    input, button {
      padding: 0.6rem;
      width: 100%;
      margin-top: 1rem;
      border: 1px solid #ccc;
      border-radius: 5px;
    }

    label {
      margin-top: 1rem;
      display: block;
      font-weight: bold;
    }

    .controls {
      margin-top: 1rem;
      text-align: center;
    }

    .controls input[type=range] {
      width: 50%;
    }
  </style>
</head>
<body>
  <div id="popup">
    <div id="popupContent">
      <h3>Introduce tu API Key de OpenAI</h3>
      <input type="password" id="apiKeyInput" placeholder="sk-..."/>
      <button onclick="saveApiKey()">Guardar</button>
    </div>
  </div>

  <h1>Spots de Surf cerca de Valencia</h1>

  <div class="controls">
    <label for="distance">Distancia máx. desde tu ubicación (km): <span id="distVal">100</span></label>
    <input type="range" id="distance" min="10" max="200" value="100" oninput="document.getElementById('distVal').textContent = this.value"/>
  </div>

  <table>
    <thead>
      <tr>
        <th>Spot</th>
        <th>Altura de Olas</th>
        <th>Viento</th>
        <th>Comentarios</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>Malvarrosa Beach</td>
        <td>0.3 - 0.5 m</td>
        <td>15 - 20 km/h NE</td>
        <td>Olas pequeñas y consistentes; ideal para principiantes e intermedios.</td>
      </tr>
      <tr>
        <td>Playa de Levante</td>
        <td>0.3 - 0.5 m</td>
        <td>15 - 20 km/h NE</td>
        <td>Condiciones similares a Malvarrosa; fácil acceso y ambiente urbano.</td>
      </tr>
      <tr>
        <td>El Saler</td>
        <td>0.3 - 0.5 m</td>
        <td>15 - 20 km/h NE</td>
        <td>Playa tranquila con olas suaves; adecuada para sesiones relajadas.</td>
      </tr>
      <tr>
        <td>Playa de las Arenas</td>
        <td>0.3 - 0.5 m</td>
        <td>15 - 20 km/h NE</td>
        <td>Spot popular en verano; olas pequeñas y consistentes.</td>
      </tr>
      <tr>
        <td>Cullera/Júcar</td>
        <td>Plano</td>
        <td>5 km/h NNW</td>
        <td>Actualmente sin olas; mejor en invierno o con condiciones específicas.</td>
      </tr>
      <tr>
        <td>Sagunto</td>
        <td>Plano</td>
        <td>4 km/h N</td>
        <td>Sin actividad de olas en este momento; consultar pronósticos futuros.</td>
      </tr>
      <tr>
        <td>Platja de Xeraco</td>
        <td>0.3 - 0.5 m</td>
        <td>5 km/h NNW</td>
        <td>Olas pequeñas; adecuado para principiantes.</td>
      </tr>
      <tr>
        <td>El Perelló</td>
        <td>0.3 - 0.5 m</td>
        <td>15 - 20 km/h NE</td>
        <td>Spot menos concurrido; ideal para evitar multitudes.</td>
      </tr>
    </tbody>
  </table>

  <script>
    // Guardar la API Key
    function saveApiKey() {
      const key = document.getElementById("apiKeyInput").value.trim();
      if (key.startsWith("sk-")) {
        localStorage.setItem("openai_api_key", key);
        document.getElementById("popup").style.display = "none";
        getLocation();
      } else {
        alert("Introduce una API key válida que empiece con 'sk-'");
      }
    }

    // Mostrar popup si no hay key guardada
    window.onload = () => {
      const savedKey = localStorage.getItem("openai_api_key");
      if (!savedKey) {
        document.getElementById("popup").style.display = "flex";
      } else {
        document.getElementById("popup").style.display = "none";
        getLocation();
      }
    }

    // Obtener ubicación del usuario
    function getLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          pos => {
            const lat = pos.coords.latitude;
            const lon = pos.coords.longitude;
            console.log("Ubicación:", lat, lon);
            // Aquí puedes integrar llamadas a APIs de spots usando la ubicación
          },
          err => {
            alert("No se pudo obtener tu ubicación.");
            console.error(err);
          }
        );
      } else {
        alert("Tu navegador no soporta geolocalización.");
      }
    }
  </script>
</body>
</html>